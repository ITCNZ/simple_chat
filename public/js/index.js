"use strict";function sendMsg(){var e=info.text().trim();if(e){info.text("").focus(),socket.emit("send msg",e);var t=$('<li class="info mine_info"></li>'),o=$('<span class="info_time mine_info_time">'+getTime()+"</span>"),n=$('<p class="info_user mine_info_user"></p>').text($.cookie("name")).prepend(o),s=$('<p class="info_content mine_info_content"></p>').text(e);t.append(n).append(s),msg.append(t),msg.scrollTop(99999999999999)}else alert("请输入内容")}function strLen(e){return e.replace(/[^\x00-\xff]/g,"00").length}function getTime(){var e=new Date;return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "+e.getHours().toString().padStart(2,0)+":"+e.getMinutes().toString().padStart(2,0)+":"+e.getSeconds().toString().padStart(2,0)}var socket=io.connect(),msg=$(".msg"),users=$(".users"),sendBtn=$(".send_btn"),clearBtn=$(".clear_btn"),info=$(".say_info"),content=$(".content_saying"),addRoom=$(".addRoom"),roomsList=$(".rooms_list"),onlineNum=$(".onlineNum"),now=$(".now"),ctrl=!1;socket.emit("online",$.cookie("name")),socket.on("refresh users",function(e){users.empty();var t=!0,o=!1,n=void 0;try{for(var s,r=e[Symbol.iterator]();!(t=(s=r.next()).done);t=!0){var i=s.value,a=$("<li></li>").text(i);i==$.cookie("name")&&a.addClass("me"),users.append(a)}}catch(e){o=!0,n=e}finally{try{!t&&r.return&&r.return()}finally{if(o)throw n}}}),socket.on("existed user",function(){for(var e=prompt("您的用户名与已在线的用户冲突，请换名重新登录");!e||strLen(e)>20;)e=prompt("用户名的格式不正确，不能为空或者大于20");$.cookie("name",e),socket.emit("online",$.cookie("name"))}),socket.on("refresh rooms",function(e){var t=e.rooms,o=e.active;roomsList.empty();var n=!0,s=!1,r=void 0;try{for(var i,a=Object.keys(t)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var c=i.value,l=$('<li data-room="'+c+'"></li>'),m=$('<span class="room"></span>').text(c),p=$('<span class="usersNum">'+t[c].length+"人</span>");c==o&&l.addClass("active_room"),l.append(m).append(p),roomsList.append(l)}}catch(e){s=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(s)throw r}}now.text(o)}),socket.on("online number",function(e){onlineNum.text(e),onlineNum.attr("title","总共"+e+"人在线")}),addRoom.click(function(){var e=prompt("请输入房间的名字"),t=!1;e=e?e.trim():"",Array.from($(".rooms_list li .room")).forEach(function(o){o.innerText==e&&(t=!0,alert("房间已经存在"))});var o=strLen(e);o>20?alert("房间名字长度超过20"):o>0&&!t&&(socket.emit("add room",e),socket.emit("change room",e))}),roomsList.click(function(e){if("active_room"!=$(e.target).closest("li").attr("class")){var t=$(e.target).closest("li").data("room");t&&(console.log($.cookie("name")+" to "+t),socket.emit("change room",t),$(".rooms_list li").removeClass("active_room"),$(e.target).closest("li").addClass("active_room"))}}),clearBtn.click(function(){msg.empty()}),socket.on("system",function(e){var t=$('<li class="system"></li>').text(e);msg.append(t),msg.scrollTop(9999999999999)}),sendBtn.click(sendMsg),document.onkeydown=function(e){17==e.keyCode&&(ctrl=!0)},document.onkeyup=function(e){17==e.keyCode&&(ctrl=!1)},info.keydown(function(e){if(13==e.keyCode)return ctrl?(sendMsg(),!1):(document.execCommand("insertHTML",!1,"<br><br>"),!1)}),socket.on("send msg",function(e){var t=$('<li class="info"></li>'),o=$('<span class="info_time others_info_time">'+e.time+"</span>"),n=$('<p class="info_user others_info_user"></p>').text(e.name).append(o),s=$('<p class="info_content others_info_content"></p>').text(e.content);t.append(n).append(s),msg.append(t),msg.scrollTop(99999999999999)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInNlbmRNc2ciLCJjb250ZW50IiwiaW5mbyIsInRleHQiLCJ0cmltIiwiY2xlYXJCdG4iLCJmb2N1cyIsInNvY2tldCIsImVtaXQiLCJsaV9pbmZvIiwiJCIsImRvY3VtZW50IiwiZ2V0VGltZSIsImUiLCJjb29raWUiLCJwcmVwZW5kIiwic3Bhbl90aW1lIiwicF9jb250ZW50Iiwia2V5Q29kZSIsInBfdXNlciIsImFwcGVuZCIsIm1zZyIsInNjcm9sbFRvcCIsImVtcHR5Iiwic3RyTGVuIiwic3RyIiwicmVwbGFjZSIsImxlbmd0aCIsIm5vdyIsIkRhdGUiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsInRvU3RyaW5nIiwicGFkU3RhcnQiLCJnZXRTZWNvbmRzIiwiaW8iLCJjb25uZWN0IiwidXNlcnMiLCJzZW5kQnRuIiwiYWRkUm9vbSIsInJvb21zTGlzdCIsIm9ubGluZU51bSIsIm9uIiwidXNlcnNOYW1lIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJ1bmRlZmluZWQiLCJ1c2VyTmFtZSIsIl9zdGVwIiwidmFsdWUiLCJsaSIsImFkZENsYXNzIiwiZXJyIiwiX2l0ZXJhdG9yIiwicmV0dXJuIiwibmFtZSIsInByb21wdCIsIl9yZWYiLCJyb29tcyIsImFjdGl2ZSIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yIiwiX2RpZEl0ZXJhdG9yRXJyb3IyIiwiX2l0ZXJhdG9yRXJyb3IyIiwiX3N0ZXAyIiwiX2l0ZXJhdG9yMiIsIk9iamVjdCIsImtleXMiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwicm9vbSIsInNwYW5fcm9vbSIsImxpX3Jvb20iLCJzcGFuX251bSIsIm51bSIsImF0dHIiLCJjbGljayIsImV4aXN0IiwiQXJyYXkiLCJmcm9tIiwiZm9yRWFjaCIsIml0ZW0iLCJpbm5lclRleHQiLCJhbGVydCIsInJvb21MZW4iLCJ0YXJnZXQiLCJjbG9zZXN0IiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmVDbGFzcyIsImN0cmwiLCJvbmtleXVwIiwia2V5ZG93biIsImV4ZWNDb21tYW5kIiwidGltZSJdLCJtYXBwaW5ncyI6ImFBa0tBLFNBQVNBLFVBL0NULElBQUFDLEVBQUFDLEtBQUFDLE9BQUFDLE9BQ0FDLEdBQUFBLEVBQUFBLENBSUFILEtBQUFDLEtBQUEsSUFBQUcsUUFDQUMsT0FBQUMsS0FBVSxXQUFVUCxHQVFwQixJQUFBUSxFQUFBQyxFQUFBLG9DQUdBQyxFQUFBRCxFQUFBQSwwQ0FBZ0NFLFVBQWhDLFdBQ01DLEVBQUFILEVBQUEsNENBQWlCUCxLQUFBTyxFQUFBSSxPQUFBLFNBQUFDLFFBQUFDLEdBRHZCQyxFQUFBUCxFQUFBLGtEQUFBUCxLQUFBRixHQUlFUSxFQUFNUyxPQUFGQyxHQUFpQkMsT0FBQUgsR0FDbkJJLElBQUFELE9BQUFYLEdBRUVZLElBQUFDLFVBQU8scUJBdEJYRCxNQUFJRSxTQXlCRixTQUFBQyxPQUFBQyxHQUNELE9BQUFBLEVBQUFDLFFBQUEsZ0JBQUEsTUFBQUMsT0FHSHBCLFNBQUFLLFVBQ0UsSUFBQWdCLEVBQUEsSUFBQUMsS0F3REEsT0F2REFELEVBQUFFLGNBdURZLEtBdERaRixFQUFBRyxXQUFBLEdBc0RzQixJQXJEdEJILEVBQUFJLFVBcUQrQixJQXBEM0J2QixFQUFVQyxXQUFFdUIsV0FBQUMsU0FBaEIsRUFBQSxHQW9Ed0MsSUFuRHBDbEIsRUFBWU4sYUFBQUEsV0FBQUEsU0FBQUEsRUFBQUEsR0FtRG1DLElBbER0Q0EsRUFBRXlCLGFBQUFGLFdBQUFDLFNBQUEsRUFBQSxHQXpKakIsSUFBSTNCLE9BQVM2QixHQUFHQyxVQUFaOUIsSUFBQUEsRUFBUzZCLFFBR1BFLE1BQVE1QixFQUFFLFVBRFZXLFFBQVFYLEVBQUYsYUFDTjRCLFNBQVU1QixFQUFBLGNBQ1Y2QixLQUFBQSxFQUFVN0IsYUFDVkwsUUFBV0ssRUFBRSxtQkFDYlIsUUFBU1Es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QWxGLEVBQUFJLE9BQUEsUUFBQSxPQUFBMkQsR0FBQWxFLE9BQUFDLEtBQUEsY0FBQWlFLEdBdUVwRC9ELEVBQUUsa0JBQWtCbUYsWUFBWSxlQS9DaENqRSxFQUFBQSxFQUFJekIsUUFBSzBELFFBQVQsTUFBQVIsU0FBQSxtQkFJRjlDLFNBQUF3RSxNQUFVLFdBQ1JyQyxJQUFBQSxVQUlGbkMsT0FBQW9DLEdBQUEsU0FBQSxTQUFBekMsR0FDQXNDLElBQUFBLEVBQWM5QixFQUFBLDRCQUFZUCxLQUFBRCxHQUN4Qm1CLElBQUlvRCxPQUFPZixHQUNYckMsSUFBSTJELFVBQVEsaUJBSVZ6QyxRQUFJNkMsTUFBS0MsU0FDUEwsU0FBQUEsVUFBQSxTQUFBbkUsR0FDTSxJQUFOeUUsRUFBQUEsVUFBQVEsTUFBQSxJQUVIbkYsU0FMRG9GLFFBQUEsU0FBQWxGLEdBTWNXLElBQVYrRCxFQUFBQSxVQUFpQmQsTUFBckIsSUFFQXZFLEtBQUE4RixRQUFJVCxTQUFjMUUsR0FDaEJ5RSxHQUFNLElBQU5BLEVBQUFBLFFBQ0EsT0FBQVEsTUFDRDlGLFdBQ0d1RixJQUVGNUUsU0FBQXNGLFlBQUEsY0FBQSxFQUFBLGFBaURPLEtBNUNWMUYsT0F4QkRvQyxHQUFBLFdBQUEsU0FBQXpDLEdBNkVFLElBQUlPLEVBQVVDLEVBQUUsMEJBL0NaK0QsRUFBV2UsRUFBQUEsNENBQWZ0RixFQUFBZ0csS0FBZVYsV0FpRFhyRSxFQUFTVCxFQUFFLDhDQUE4Q1AsS0FBS0QsRUFBS3VELE1BQU1yQyxPQUFPSixHQS9DaEZDLEVBQU9QLEVBQUEsb0RBQUFQLEtBQUFELEVBQUFELFNBRVgwRixFQUFRQyxPQUFNOUUsR0FBT00sT0FBVEgsR0FpRFpJLElBQUlELE9BQU9YLEdBOUNYQyxJQUFFWSxVQUFBIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHNvY2tldCA9IGlvLmNvbm5lY3QoKTtcclxuXHJcbmNvbnN0IG1zZyA9ICQoJy5tc2cnKTtcclxuY29uc3QgdXNlcnMgPSAkKCcudXNlcnMnKTtcclxuY29uc3Qgc2VuZEJ0biA9ICQoJy5zZW5kX2J0bicpO1xyXG5jb25zdCBjbGVhckJ0biA9ICQoJy5jbGVhcl9idG4nKVxyXG5jb25zdCBpbmZvID0gJCgnLnNheV9pbmZvJyk7XHJcbmNvbnN0IGNvbnRlbnQgPSAkKCcuY29udGVudF9zYXlpbmcnKTtcclxuY29uc3QgYWRkUm9vbSA9ICQoJy5hZGRSb29tJyk7XHJcbmNvbnN0IHJvb21zTGlzdCA9ICQoJy5yb29tc19saXN0Jyk7XHJcbmNvbnN0IG9ubGluZU51bSA9ICQoJy5vbmxpbmVOdW0nKTtcclxuY29uc3Qgbm93ID0gJCgnLm5vdycpO1xyXG5sZXQgY3RybCA9IGZhbHNlO1xyXG5cclxuLy8g55m75b2VXHJcbnNvY2tldC5lbWl0KCdvbmxpbmUnLCAkLmNvb2tpZSgnbmFtZScpKTtcclxuXHJcbi8vIOWIt+aWsOeUqOaIt+WIl+ihqFxyXG5zb2NrZXQub24oJ3JlZnJlc2ggdXNlcnMnLCBmdW5jdGlvbiAodXNlcnNOYW1lKSB7XHJcbiAgdXNlcnMuZW1wdHkoKTtcclxuICBmb3IgKGxldCB1c2VyTmFtZSBvZiB1c2Vyc05hbWUpIHtcclxuICAgIGxldCBsaSA9ICQoJzxsaT48L2xpPicpLnRleHQodXNlck5hbWUpO1xyXG4gICAgaWYgKHVzZXJOYW1lID09ICQuY29va2llKCduYW1lJykpIHtcclxuICAgICAgbGkuYWRkQ2xhc3MoJ21lJylcclxuICAgIH1cclxuICAgIHVzZXJzLmFwcGVuZChsaSlcclxuICB9XHJcbn0pXHJcblxyXG4vLyDnlKjmiLflkI3lhrLnqoFcclxuc29ja2V0Lm9uKCdleGlzdGVkIHVzZXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgbGV0IG5hbWUgPSBwcm9tcHQoJ+aCqOeahOeUqOaIt+WQjeS4juW3suWcqOe6v+eahOeUqOaIt+WGsueqge+8jOivt+aNouWQjemHjeaWsOeZu+W9lScpO1xyXG4gIHdoaWxlKCFuYW1lIHx8IHN0ckxlbihuYW1lKSA+IDIwKSB7XHJcbiAgICBuYW1lID0gcHJvbXB0KCfnlKjmiLflkI3nmoTmoLzlvI/kuI3mraPnoa7vvIzkuI3og73kuLrnqbrmiJbogIXlpKfkuo4yMCcpO1xyXG4gIH1cclxuICAkLmNvb2tpZSgnbmFtZScsIG5hbWUpXHJcbiAgc29ja2V0LmVtaXQoJ29ubGluZScsICQuY29va2llKCduYW1lJykpO1xyXG59KVxyXG5cclxuLy8g5Yi35paw5oi/6Ze05YiX6KGoXHJcbnNvY2tldC5vbigncmVmcmVzaCByb29tcycsIGZ1bmN0aW9uICh7cm9vbXMsIGFjdGl2ZX0pIHtcclxuICByb29tc0xpc3QuZW1wdHkoKTtcclxuICBmb3IgKGxldCByb29tIG9mIE9iamVjdC5rZXlzKHJvb21zKSkge1xyXG4gICAgLy8gaWYgKHJvb20gPT0gYWN0aXZlKSB7XHJcbiAgICAvLyAgIHJvb21zTGlzdC5hcHBlbmQoYDxsaSBjbGFzcz1cImFjdGl2ZV9yb29tXCIgZGF0YS1yb29tPVwiJHtyb29tfVwiPlxyXG4gICAgLy8gICAgIDxzcGFuIGNsYXNzPVwicm9vbVwiPiR7cm9vbX08L3NwYW4+XHJcbiAgICAvLyAgICAgPHNwYW4gY2xhc3M9XCJ1c2Vyc051bVwiPiR7cm9vbXNbcm9vbV0ubGVuZ3RofeS6ujwvc3Bhbj5cclxuICAgIC8vICAgPC9saT5gKVxyXG4gICAgLy8gfSBlbHNlIHtcclxuICAgIC8vICAgcm9vbXNMaXN0LmFwcGVuZChgPGxpIGRhdGEtcm9vbT1cIiR7cm9vbX1cIj5cclxuICAgIC8vICAgICA8c3BhbiBjbGFzcz1cInJvb21cIj4ke3Jvb219PC9zcGFuPlxyXG4gICAgLy8gICAgIDxzcGFuIGNsYXNzPVwidXNlcnNOdW1cIj4ke3Jvb21zW3Jvb21dLmxlbmd0aH3kuro8L3NwYW4+XHJcbiAgICAvLyAgIDwvbGk+YClcclxuICAgIC8vIH1cclxuICAgIGxldCBsaV9yb29tID0gJChgPGxpIGRhdGEtcm9vbT1cIiR7cm9vbX1cIj48L2xpPmApO1xyXG4gICAgbGV0IHNwYW5fcm9vbSA9ICQoJzxzcGFuIGNsYXNzPVwicm9vbVwiPjwvc3Bhbj4nKS50ZXh0KHJvb20pXHJcbiAgICBsZXQgc3Bhbl9udW0gPSAkKGA8c3BhbiBjbGFzcz1cInVzZXJzTnVtXCI+JHtyb29tc1tyb29tXS5sZW5ndGh95Lq6PC9zcGFuPmApO1xyXG4gICAgaWYgKHJvb20gPT0gYWN0aXZlKSB7XHJcbiAgICAgIGxpX3Jvb20uYWRkQ2xhc3MoJ2FjdGl2ZV9yb29tJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGxpX3Jvb20uYXBwZW5kKHNwYW5fcm9vbSkuYXBwZW5kKHNwYW5fbnVtKTtcclxuICAgIHJvb21zTGlzdC5hcHBlbmQobGlfcm9vbSk7XHJcbiAgfVxyXG4gIG5vdy50ZXh0KGFjdGl2ZSk7XHJcbn0pXHJcblxyXG4vLyDnlKjmiLfkurrmlbBcclxuc29ja2V0Lm9uKCdvbmxpbmUgbnVtYmVyJywgZnVuY3Rpb24gKG51bSkge1xyXG4gIG9ubGluZU51bS50ZXh0KG51bSlcclxuICBvbmxpbmVOdW0uYXR0cigndGl0bGUnLCBg5oC75YWxJHtudW195Lq65Zyo57q/YClcclxufSlcclxuXHJcbi8vIOa3u+WKoOaIv+mXtFxyXG5hZGRSb29tLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICBsZXQgcm9vbSA9IHByb21wdCgn6K+36L6T5YWl5oi/6Ze055qE5ZCN5a2XJyk7XHJcbiAgbGV0IGV4aXN0ID0gZmFsc2VcclxuICByb29tID0gcm9vbSA/IHJvb20udHJpbSgpIDogJyc7XHJcbiAgXHJcbiAgQXJyYXkuZnJvbSgkKCcucm9vbXNfbGlzdCBsaSAucm9vbScpKS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgaWYgKGl0ZW0uaW5uZXJUZXh0ID09IHJvb20pIHtcclxuICAgICAgZXhpc3QgPSB0cnVlO1xyXG4gICAgICBhbGVydCgn5oi/6Ze05bey57uP5a2Y5ZyoJyk7XHJcbiAgICB9XHJcbiAgfSlcclxuICBsZXQgcm9vbUxlbiA9IHN0ckxlbihyb29tKTtcclxuXHJcbiAgaWYgKHJvb21MZW4gPiAyMCkge1xyXG4gICAgYWxlcnQoJ+aIv+mXtOWQjeWtl+mVv+W6pui2hei/hzIwJyk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGlmIChyb29tTGVuID4gMCAmJiAhZXhpc3QpIHtcclxuICAgIC8vICQoJy5yb29tc19saXN0IGxpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZV9yb29tJyk7XHJcbiAgICAvLyByb29tc0xpc3QuYXBwZW5kKGA8bGkgY2xhc3M9XCJhY3RpdmVfcm9vbVwiPiR7cm9vbX08L2xpPmApO1xyXG4gICAgXHJcbiAgICBzb2NrZXQuZW1pdCgnYWRkIHJvb20nLCByb29tKTtcclxuICAgIHNvY2tldC5lbWl0KCdjaGFuZ2Ugcm9vbScsIHJvb20pO1xyXG4gIH1cclxufSlcclxuXHJcbi8vIOWIh+aNouaIv+mXtFxyXG5yb29tc0xpc3QuY2xpY2soZnVuY3Rpb24gKGUpIHtcclxuICBpZiAoJChlLnRhcmdldCkuY2xvc2VzdCgnbGknKS5hdHRyKCdjbGFzcycpID09ICdhY3RpdmVfcm9vbScpIHJldHVybjtcclxuICBcclxuICBsZXQgcm9vbSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ2xpJykuZGF0YSgncm9vbScpO1xyXG5cclxuICBpZiAoIXJvb20pIHJldHVybjtcclxuXHJcbiAgY29uc29sZS5sb2coJC5jb29raWUoJ25hbWUnKSArICcgdG8gJyArIHJvb20pO1xyXG5cclxuICBzb2NrZXQuZW1pdCgnY2hhbmdlIHJvb20nLCByb29tKTtcclxuICAkKCcucm9vbXNfbGlzdCBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmVfcm9vbScpXHJcbiAgJChlLnRhcmdldCkuY2xvc2VzdCgnbGknKS5hZGRDbGFzcygnYWN0aXZlX3Jvb20nKVxyXG59KVxyXG5cclxuLy8g5riF5bGPXHJcbmNsZWFyQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICBtc2cuZW1wdHkoKTtcclxufSlcclxuXHJcbi8vIOezu+e7n+a2iOaBr+mAmuefpVxyXG5zb2NrZXQub24oJ3N5c3RlbScsIGZ1bmN0aW9uIChpbmZvKSB7XHJcbiAgbGV0IGxpX3N5cyA9ICQoJzxsaSBjbGFzcz1cInN5c3RlbVwiPjwvbGk+JykudGV4dChpbmZvKVxyXG4gIG1zZy5hcHBlbmQobGlfc3lzKTtcclxuICBtc2cuc2Nyb2xsVG9wKDk5OTk5OTk5OTk5OTkpO1xyXG59KVxyXG5cclxuLy8g5Y+R6YCB5raI5oGvXHJcbnNlbmRCdG4uY2xpY2soc2VuZE1zZylcclxuZG9jdW1lbnQub25rZXlkb3duID0gZnVuY3Rpb24gKGUpIHtcclxuICBpZiAoZS5rZXlDb2RlID09IDE3KSBjdHJsID0gdHJ1ZTtcclxufVxyXG5kb2N1bWVudC5vbmtleXVwID0gZnVuY3Rpb24gKGUpIHtcclxuICBpZiAoZS5rZXlDb2RlID09IDE3KSBjdHJsID0gZmFsc2U7XHJcbn1cclxuaW5mby5rZXlkb3duKGZ1bmN0aW9uIChlKSB7XHJcbiAgaWYgKGUua2V5Q29kZSA9PSAxMykge1xyXG4gICAgaWYgKGN0cmwpIHtcclxuICAgICAgc2VuZE1zZygpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgnaW5zZXJ0SFRNTCcsIGZhbHNlLCAnPGJyPjxicj4nKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn0pXHJcblxyXG5zb2NrZXQub24oJ3NlbmQgbXNnJywgZnVuY3Rpb24gKGluZm8pIHtcclxuICAvLyBtc2cuYXBwZW5kKGA8bGkgY2xhc3M9XCJpbmZvXCI+XHJcbiAgLy8gICA8cCBjbGFzcz1cImluZm9fdXNlciBvdGhlcnNfaW5mb191c2VyXCI+JHtpbmZvLm5hbWV9PC9wPlxyXG4gIC8vICAgPHAgY2xhc3M9XCJpbmZvX2NvbnRlbnQgb3RoZXJzX2luZm9fY29udGVudFwiPiR7aW5mby5jb250ZW50fTwvcD5cclxuICAvLyA8L2xpPmApXHJcbiAgbGV0IGxpX2luZm8gPSAkKCc8bGkgY2xhc3M9XCJpbmZvXCI+PC9saT4nKTtcclxuICBsZXQgc3Bhbl90aW1lID0gJChgPHNwYW4gY2xhc3M9XCJpbmZvX3RpbWUgb3RoZXJzX2luZm9fdGltZVwiPiR7aW5mby50aW1lfTwvc3Bhbj5gKVxyXG4gIGxldCBwX3VzZXIgPSAkKCc8cCBjbGFzcz1cImluZm9fdXNlciBvdGhlcnNfaW5mb191c2VyXCI+PC9wPicpLnRleHQoaW5mby5uYW1lKS5hcHBlbmQoc3Bhbl90aW1lKTtcclxuICBsZXQgcF9jb250ZW50ID0gJCgnPHAgY2xhc3M9XCJpbmZvX2NvbnRlbnQgb3RoZXJzX2luZm9fY29udGVudFwiPjwvcD4nKS50ZXh0KGluZm8uY29udGVudCk7XHJcblxyXG4gIGxpX2luZm8uYXBwZW5kKHBfdXNlcikuYXBwZW5kKHBfY29udGVudCk7XHJcbiAgbXNnLmFwcGVuZChsaV9pbmZvKTtcclxuXHJcbiAgbXNnLnNjcm9sbFRvcCg5OTk5OTk5OTk5OTk5OSlcclxufSlcclxuXHJcbmZ1bmN0aW9uIHNlbmRNc2cgKCkge1xyXG4gIGxldCBjb250ZW50ID0gaW5mby50ZXh0KCkudHJpbSgpO1xyXG4gIGlmICghY29udGVudCkge1xyXG4gICAgYWxlcnQoJ+ivt+i+k+WFpeWGheWuuScpXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGluZm8udGV4dCgnJykuZm9jdXMoKTtcclxuICBzb2NrZXQuZW1pdCgnc2VuZCBtc2cnLCBjb250ZW50KTtcclxuXHJcbiAgLy8gbXNnLmFwcGVuZChgPGxpIGNsYXNzPVwiaW5mbyBtaW5lX2luZm9cIj5cclxuICAvLyAgIDxwIGNsYXNzPVwiaW5mb191c2VyIG1pbmVfaW5mb191c2VyXCI+JHskLmNvb2tpZSgnbmFtZScpfTwvcD5cclxuICAvLyAgIDxwIGNsYXNzPVwiaW5mb19jb250ZW50IG1pbmVfaW5mb19jb250ZW50XCI+JHtjb250ZW50fTwvcD5cclxuICAvLyA8L2xpPmApXHJcblxyXG4gIC8vIG1zZy5hcHBlbmQoJChgPGxpIGNsYXNzPVwiaW5mbyBtaW5lX2luZm9cIj5cclxuICAvLyAgIDxwIGNsYXNzPVwiaW5mb191c2VyIG1pbmVfaW5mb191c2VyXCI+JHskLmNvb2tpZSgnbmFtZScpfTwvcD5cclxuICAvLyA8L2xpPmApLmFwcGVuZCgkKCc8cCBjbGFzcz1cImluZm9fY29udGVudCBtaW5lX2luZm9fY29udGVudFwiPjwvcD4nKS50ZXh0KGNvbnRlbnQpKSlcclxuICBsZXQgbGlfaW5mbyA9ICQoJzxsaSBjbGFzcz1cImluZm8gbWluZV9pbmZvXCI+PC9saT4nKTtcclxuICBsZXQgc3Bhbl90aW1lID0gJChgPHNwYW4gY2xhc3M9XCJpbmZvX3RpbWUgbWluZV9pbmZvX3RpbWVcIj4ke2dldFRpbWUoKX08L3NwYW4+YClcclxuICBsZXQgcF91c2VyID0gJCgnPHAgY2xhc3M9XCJpbmZvX3VzZXIgbWluZV9pbmZvX3VzZXJcIj48L3A+JykudGV4dCgkLmNvb2tpZSgnbmFtZScpKS5wcmVwZW5kKHNwYW5fdGltZSk7XHJcbiAgbGV0IHBfY29udGVudCA9ICQoJzxwIGNsYXNzPVwiaW5mb19jb250ZW50IG1pbmVfaW5mb19jb250ZW50XCI+PC9wPicpLnRleHQoY29udGVudCk7XHJcblxyXG4gIGxpX2luZm8uYXBwZW5kKHBfdXNlcikuYXBwZW5kKHBfY29udGVudCk7XHJcbiAgbXNnLmFwcGVuZChsaV9pbmZvKTtcclxuICBcclxuICBtc2cuc2Nyb2xsVG9wKDk5OTk5OTk5OTk5OTk5KVxyXG59XHJcblxyXG5mdW5jdGlvbiBzdHJMZW4gKHN0cikge1xyXG4gIHJldHVybiBzdHIucmVwbGFjZSgvW15cXHgwMC1cXHhmZl0vZywgJzAwJykubGVuZ3RoXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRpbWUgKCkge1xyXG4gIGxldCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gIGxldCB5ZWFyID0gbm93LmdldEZ1bGxZZWFyKCk7XHJcbiAgbGV0IG1vbnRoID0gbm93LmdldE1vbnRoKCkgKyAxO1xyXG4gIGxldCBkYXRlID0gbm93LmdldERhdGUoKTtcclxuICBsZXQgaG91ciA9IG5vdy5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgMCk7XHJcbiAgbGV0IG1pbnV0ZSA9IG5vdy5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAwKTtcclxuICBsZXQgc2Vjb25kID0gbm93LmdldFNlY29uZHMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIDApO1xyXG5cclxuICByZXR1cm4geWVhcisnLycrbW9udGgrJy8nK2RhdGUrJyAnK2hvdXIrJzonK21pbnV0ZSsnOicrc2Vjb25kXHJcbn0iXX0=
